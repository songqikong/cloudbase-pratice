<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="login-prompt" wx:if="{{!isLoggedIn && !loading}}">
    <text class="login-icon">ğŸ‘¤</text>
    <text class="login-text">è¯·å…ˆç™»å½•ä½¿ç”¨å®Œæ•´åŠŸèƒ½</text>
    <view class="login-btn" bindtap="performLogin">
      <text>ç«‹å³ç™»å½•</text>
    </view>
  </view>

  <!-- å·²ç™»å½•å†…å®¹ -->
  <view wx:if="{{isLoggedIn && !loading}}">
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <view class="user-card">
      <view class="user-header">
        <image class="user-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
        <view class="user-info">
          <view class="user-name">{{userInfo.name}}</view>
          <view class="user-join-date">åŠ å…¥æ—¶é—´ï¼š{{userInfo.joinDate}}</view>
        </view>
        <view class="edit-btn" bindtap="editProfile">
          <text>ç¼–è¾‘</text>
        </view>
      </view>
    </view>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-section">
      <view class="stats-grid">
        <view class="stat-item" wx:for="{{stats}}" wx:key="label">
          <text class="stat-icon">{{item.icon}}</text>
          <text class="stat-value">{{item.value}}</text>
          <text class="stat-label">{{item.label}}</text>
        </view>
      </view>
    </view>

    <!-- å·²é¢„çº¦è¯¾ç¨‹ -->
    <view class="courses-section">
      <view class="section-header">
        <text class="section-title">æˆ‘çš„è¯¾ç¨‹</text>
        <text class="course-count">{{bookedCourses.length}}é—¨è¯¾ç¨‹</text>
      </view>
      
      <!-- è¯¾ç¨‹åŠ è½½çŠ¶æ€ -->
      <view class="courses-loading" wx:if="{{loadingBookings}}">
        <view class="loading-spinner small"></view>
        <text class="loading-text">åŠ è½½è¯¾ç¨‹ä¸­...</text>
      </view>
      
      <view class="course-list" wx:if="{{!loadingBookings && bookedCourses.length > 0}}">
        <view class="course-card" wx:for="{{bookedCourses}}" wx:key="id" bindtap="goToCourseDetail" data-id="{{item.id}}">
          <image class="course-image" src="{{item.image}}" mode="aspectFill"></image>
          
          <!-- è¯¾ç¨‹çŠ¶æ€æ ‡ç­¾ -->
          <view class="status-badge status-{{item.status}}">
            {{item.status === 'upcoming' ? 'å³å°†å¼€å§‹' : item.status === 'completed' ? 'å·²å®Œæˆ' : 'å·²å–æ¶ˆ'}}
          </view>
          
          <view class="course-info">
            <view class="course-title">{{item.title}}</view>
            <view class="course-subtitle">{{item.subtitle}}</view>
            
            <view class="course-details">
              <view class="detail-item">
                <text class="detail-icon">ğŸ•</text>
                <text class="detail-text">{{item.courseTimeDisplay}}</text>
              </view>
              <view class="detail-item">
                <text class="detail-icon">ğŸ“</text>
                <text class="detail-text">{{item.locationShort}}</text>
              </view>
              <view class="detail-item">
                <text class="detail-icon">ğŸ‘¨â€ğŸ«</text>
                <text class="detail-text">{{item.instructor.name}}</text>
              </view>
            </view>
            
            <view class="course-footer">
              <view class="booking-date">
                <text class="booking-label">é¢„çº¦æ—¶é—´ï¼š{{item.bookingDate}}</text>
              </view>
              <view class="course-actions" wx:if="{{item.status === 'upcoming'}}" catchtap="cancelBooking" data-id="{{item.id}}">
                <text class="cancel-text">å–æ¶ˆé¢„çº¦</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-courses" wx:if="{{!loadingBookings && bookedCourses.length === 0}}">
        <text class="empty-icon">ğŸ“š</text>
        <text class="empty-text">è¿˜æ²¡æœ‰é¢„çº¦è¯¾ç¨‹</text>
        <text class="empty-subtitle">å»é¦–é¡µçœ‹çœ‹æœ‰ä»€ä¹ˆå¥½è¯¾ç¨‹å§</text>
        <navigator url="/pages/index/index" class="goto-home-btn">
          <text>æµè§ˆè¯¾ç¨‹</text>
        </navigator>
      </view>
    </view>

    <!-- åŠŸèƒ½èœå• -->
    <view class="menu-section">
      <view class="menu-group">
        <view class="menu-item" bindtap="contactService">
          <text class="menu-icon">ğŸ’¬</text>
          <text class="menu-text">è”ç³»å®¢æœ</text>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="feedback">
          <text class="menu-icon">ğŸ“</text>
          <text class="menu-text">æ„è§åé¦ˆ</text>
          <text class="menu-arrow">></text>
        </view>
        <view class="menu-item" bindtap="aboutUs">
          <text class="menu-icon">â„¹ï¸</text>
          <text class="menu-text">å…³äºæˆ‘ä»¬</text>
          <text class="menu-arrow">></text>
        </view>
      </view>
    </view>
  </view>
</view> 