<view class="container" wx:if="{{!loading && courseDetail}}">
  <!-- è¯¾ç¨‹ä¸»å›¾ -->
  <view class="hero-section">
    <image class="course-main-image" src="{{courseDetail.image}}" mode="aspectFill"></image>
    <view class="hero-overlay">
      <view class="free-badge">å…è´¹</view>
    </view>
  </view>

  <!-- è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ -->
  <view class="course-info-section">
    <view class="course-header">
      <view class="course-title">{{courseDetail.title}}</view>
      <view class="course-subtitle">{{courseDetail.subtitle}}</view>
      
      <view class="course-meta">
        <view class="rating-section">
          <text class="rating-star">â­</text>
          <text class="rating-score">{{courseDetail.rating}}</text>
          <text class="rating-count">({{courseDetail.reviewCount}}äººè¯„ä»·)</text>
        </view>
        <view class="participants-info">
          <text class="participants-count">{{courseDetail.currentStudents}}/{{courseDetail.maxStudents}}äºº</text>
        </view>
      </view>

      <view class="course-tags">
        <text class="tag" wx:for="{{courseDetail.tags}}" wx:key="*this">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- è¯¾ç¨‹æ—¶é—´åœ°ç‚¹ -->
  <view class="schedule-section">
    <view class="section-title">ğŸ“… è¯¾ç¨‹å®‰æ’</view>
    <view class="schedule-card">
      <view class="schedule-item">
        <text class="schedule-icon">ğŸ•</text>
        <view class="schedule-info">
          <text class="schedule-label">ä¸Šè¯¾æ—¶é—´</text>
          <text class="schedule-value">{{courseDetail.courseTimeDisplay}}</text>
        </view>
      </view>
      <view class="schedule-item">
        <text class="schedule-icon">ğŸ“</text>
        <view class="schedule-info">
          <text class="schedule-label">ä¸Šè¯¾åœ°ç‚¹</text>
          <text class="schedule-value" bindtap="showLocation">{{courseDetail.location}}</text>
        </view>
      </view>
      <view class="schedule-item">
        <text class="schedule-icon">â±</text>
        <view class="schedule-info">
          <text class="schedule-label">è¯¾ç¨‹æ—¶é•¿</text>
          <text class="schedule-value">{{courseDetail.duration}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¯¼å¸ˆä»‹ç» -->
  <view class="instructor-section">
    <view class="section-title">ğŸ‘¨â€ğŸ« å¯¼å¸ˆä»‹ç»</view>
    <view class="instructor-card">
      <image class="instructor-avatar" src="{{courseDetail.instructor.avatar}}" mode="aspectFill"></image>
      <view class="instructor-info">
        <view class="instructor-name">{{courseDetail.instructor.name}}</view>
        <view class="instructor-title">{{courseDetail.instructor.title}}</view>
        <view class="instructor-stats">
          <text class="stat-item">{{courseDetail.instructor.experience}}</text>
          <text class="stat-item">æˆåŠŸç‡ {{courseDetail.instructor.successRate}}</text>
        </view>
      </view>
      <view class="contact-btn" bindtap="contactInstructor">
        <text>è”ç³»</text>
      </view>
    </view>
  </view>

  <!-- è¯¾ç¨‹æè¿° -->
  <view class="description-section">
    <view class="section-title">ğŸ“ è¯¾ç¨‹ä»‹ç»</view>
    <view class="description-content">{{courseDetail.description}}</view>
  </view>

  <!-- è¯¾ç¨‹å¤§çº² -->
  <view class="outline-section">
    <view class="section-title">ğŸ“‹ è¯¾ç¨‹å¤§çº²</view>
    <view class="outline-list">
      <view class="outline-item" wx:for="{{courseDetail.outline}}" wx:key="title">
        <view class="outline-number">{{index + 1}}</view>
        <view class="outline-content">
          <view class="outline-title">{{item.title}}</view>
          <view class="outline-description">{{item.content}}</view>
          <view class="outline-duration">{{item.duration}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ä½ å°†æ”¶è· -->
  <view class="benefits-section">
    <view class="section-title">ğŸ¯ ä½ å°†æ”¶è·</view>
    <view class="benefits-list">
      <view class="benefit-item" wx:for="{{courseDetail.benefits}}" wx:key="*this">
        <text class="benefit-icon">âœ…</text>
        <text class="benefit-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- é€‚åˆäººç¾¤ -->
  <view class="audience-section">
    <view class="section-title">ğŸ‘¥ é€‚åˆäººç¾¤</view>
    <view class="audience-list">
      <view class="audience-item" wx:for="{{courseDetail.audience}}" wx:key="*this">
        <text class="audience-icon">ğŸ‘¤</text>
        <text class="audience-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- æ³¨æ„äº‹é¡¹ -->
  <view class="notices-section">
    <view class="section-title">âš ï¸ æ³¨æ„äº‹é¡¹</view>
    <view class="notices-list">
      <view class="notice-item" wx:for="{{courseDetail.notices}}" wx:key="*this">
        <text class="notice-bullet">â€¢</text>
        <text class="notice-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨é¢„çº¦åŒºåŸŸ -->
  <view class="booking-footer">
    <view class="participants-bar">
      <view class="participants-fill" style="width: {{(courseDetail.currentStudents / courseDetail.maxStudents * 100)}}%"></view>
    </view>
    <view class="booking-info">
      <text class="participants-text">å·²æŠ¥å {{courseDetail.currentStudents}}/{{courseDetail.maxStudents}} äºº</text>
    </view>
    <view class="booking-actions">
      <button class="cancel-btn" wx:if="{{isBooked}}" bindtap="cancelBooking" 
              disabled="{{bookingLoading}}" loading="{{bookingLoading}}">
        {{bookingLoading ? 'å–æ¶ˆä¸­...' : 'å–æ¶ˆé¢„çº¦'}}
      </button>
      <button class="book-btn" wx:else bindtap="bookCourse" 
              disabled="{{courseDetail.currentStudents >= courseDetail.maxStudents || bookingLoading}}"
              loading="{{bookingLoading}}">
        {{bookingLoading ? 'é¢„çº¦ä¸­...' : (courseDetail.currentStudents >= courseDetail.maxStudents ? 'è¯¾ç¨‹å·²æ»¡' : 'ç«‹å³é¢„çº¦')}}
      </button>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading}}">
  <view class="loading-content">
    <view class="loading-spinner">
      <text class="loading-icon">â³</text>
      <text class="loading-text">æ­£åœ¨åŠ è½½è¯¾ç¨‹è¯¦æƒ…...</text>
    </view>
  </view>
</view>

<!-- é”™è¯¯çŠ¶æ€ -->
<view class="error-container" wx:elif="{{loadError}}">
  <view class="error-content">
    <text class="error-icon">ğŸ˜</text>
    <text class="error-text">åŠ è½½å¤±è´¥</text>
    <text class="error-subtitle">ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·é‡è¯•</text>
    <button class="retry-button" bindtap="retryLoad">é‡æ–°åŠ è½½</button>
  </view>
</view> 